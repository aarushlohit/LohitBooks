<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Book ‚Äî Viewer</title>
  <style>
    :root {
      --bg: #0b0c10;
      --panel: #111217;
      --text: #e8e8ea;
      --muted: #a3a3ad;
      --accent: #6aa6ff;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; background: radial-gradient(1200px 800px at 70% -10%, #171a22 0%, var(--bg) 40%);
      color: var(--text); font: 16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .wrap { max-width: 1100px; margin: 24px auto; padding: 0 16px; }

    header {
      display: flex; align-items: center; justify-content: space-between;
      gap: 12px; padding: 14px 16px; background: color-mix(in oklab, var(--panel) 90%, white 10%);
      border: 1px solid #20222b; border-radius: var(--radius); box-shadow: var(--shadow);
      position: sticky; top: 12px; z-index: 20; backdrop-filter: blur(6px);
    }
    .brand { font-weight: 700; letter-spacing: .3px; }
    .controls { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; }
    .btn {
      background: #1a1b22; color: var(--text); border: 1px solid #2a2d38; border-radius: 12px;
      padding: 10px 14px; cursor: pointer; transition: .15s; display: inline-flex; align-items: center; gap: 8px;
    }
    .btn:hover { background: #202431; border-color: #384055; }
    .btn:active { transform: translateY(1px); }
    .pill {
      padding: 8px 12px; background: #161821; border: 1px solid #2a2d38; border-radius: 999px; color: var(--muted);
      display: inline-flex; align-items: center;
    }

    .viewer {
      margin-top: 16px; background: #0c0d13; border: 1px solid #1d1f27; border-radius: var(--radius);
      box-shadow: var(--shadow); overflow: hidden;
    }
    .stage {
      position: relative; width: 100%; height: min(80vh, 900px); display: grid; place-items: center;
      background: #0b0c12; isolation: isolate; overflow: auto;
    }
    .spread { max-width: 100%; max-height: 100%; border-radius: 12px; box-shadow: 0 20px 40px rgba(0,0,0,.45); }
    .spread img { display: block; max-width: 100%; max-height: 100%; border-radius: 12px; }

    .toolbar { position: absolute; bottom: 14px; left: 50%; transform: translateX(-50%);
      display: flex; gap: 8px; background: rgba(15,16,24,.7); border: 1px solid #2a2d38; border-radius: 999px;
      padding: 8px; backdrop-filter: blur(6px); }

    .counter { font-variant-numeric: tabular-nums; color: var(--muted); }

    .thumbs {
      display: grid; grid-auto-flow: column; gap: 8px; overflow-x: auto; padding: 10px;
      border-top: 1px solid #1d1f27; background: #0b0c11;
    }
    .thumbs img { height: 84px; border-radius: 8px; border: 2px solid transparent; cursor: pointer; opacity: .85; }
    .thumbs img[aria-current="true"] { border-color: var(--accent); opacity: 1; }

    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">üìñ My Book</div>
      <div class="controls">
        <button class="btn" id="prevBtn">‚¨ÖÔ∏è Prev</button>
        <button class="btn" id="nextBtn">Next ‚û°Ô∏è</button>
        <span class="pill"><span id="counter" class="counter">0 / 0</span></span>
        <button class="btn" id="zoomOut">‚ûñ Zoom</button>
        <input id="zoom" type="range" min="0.75" max="2.5" step="0.01" value="1" />
        <button class="btn" id="zoomIn">‚ûï Zoom</button>
        <button class="btn" id="toggleThumbs">üñºÔ∏è Thumbnails</button>
        <button class="btn" id="fullBtn">‚õ∂ Fullscreen</button>
      </div>
    </header>

    <main class="viewer" id="viewer">
      <div class="stage" id="stage">
        <img id="spread" class="spread" alt="Book spread" />
        <div class="toolbar">
          <button class="btn" id="prevBtn2">‚¨ÖÔ∏è Prev</button>
          <span class="pill"><span id="counter2" class="counter">0 / 0</span></span>
          <button class="btn" id="nextBtn2">Next ‚û°Ô∏è</button>
        </div>
      </div>
      <div id="thumbRow" class="thumbs hidden"></div>
    </main>
  </div>

  <script>
    // ====== CONFIG ======
    const TOTAL_SPREADS = 37;  // spread-00.jpg ... spread-36.jpg
    const IMAGE_PREFIX = 'spread-';
    const IMAGE_EXT = '.jpg';

    // ====== STATE ======
    const spreadEl = document.getElementById('spread');
    const counter = document.getElementById('counter');
    const counter2 = document.getElementById('counter2');
    const stage = document.getElementById('stage');
    const thumbRow = document.getElementById('thumbRow');
    const zoomSlider = document.getElementById('zoom');

    let spreads = [];
    let index = 0;
    let scale = 1;

    // ====== HELPERS ======
    function human(n){ return String(n).padStart(2,'0'); }
    function setCounters(){
      const t = spreads.length; const i = Math.min(index+1, t);
      counter.textContent = `${i} / ${t}`;
      counter2.textContent = `${i} / ${t}`;
    }
    function updateSpread(){
      if(!spreads.length) return;
      spreadEl.src = spreads[index].src;
      spreadEl.alt = spreads[index].name;
      [...thumbRow.querySelectorAll('img')].forEach((img, i)=>{
        img.setAttribute('aria-current', i===index ? 'true' : 'false');
      });
      setCounters();
    }
    function clampIndex(){ index = Math.max(0, Math.min(index, spreads.length-1)); }

    // ====== LOAD ======
    function loadHosted(){
      spreads = [];
      for(let i=0;i<TOTAL_SPREADS;i++){
        spreads.push({src:`${IMAGE_PREFIX}${human(i)}${IMAGE_EXT}`, name:`Spread ${i}`});
      }
      buildThumbs();
      index=0; updateSpread();
    }

    function buildThumbs(){
      thumbRow.innerHTML = '';
      spreads.forEach((sp, i)=>{
        const img = document.createElement('img');
        img.loading='lazy'; img.src=sp.src; img.alt=sp.name;
        img.addEventListener('click', ()=>{ index=i; updateSpread(); });
        if(i===index) img.setAttribute('aria-current','true');
        thumbRow.appendChild(img);
      });
      setCounters();
    }

    // ====== NAV ======
    function prev(){ index--; clampIndex(); updateSpread(); }
    function next(){ index++; clampIndex(); updateSpread(); }

    document.getElementById('prevBtn').onclick = prev;
    document.getElementById('nextBtn').onclick = next;
    document.getElementById('prevBtn2').onclick = prev;
    document.getElementById('nextBtn2').onclick = next;

    document.addEventListener('keydown', (e)=>{
      if(e.key === 'ArrowLeft') prev();
      if(e.key === 'ArrowRight') next();
      if(e.key === '+'){ scale = Math.min(2.5, scale+0.05); applyZoom(); }
      if(e.key === '-'){ scale = Math.max(0.75, scale-0.05); applyZoom(); }
    });

    // ====== ZOOM ======
    function applyZoom(){
      zoomSlider.value = scale;
      spreadEl.style.transform = `scale(${scale})`;
    }
    document.getElementById('zoomIn').onclick = ()=>{ scale=Math.min(2.5, scale+0.1); applyZoom(); };
    document.getElementById('zoomOut').onclick = ()=>{ scale=Math.max(0.75, scale-0.1); applyZoom(); };
    zoomSlider.oninput = e=>{ scale=parseFloat(e.target.value); applyZoom(); };

    // ====== FULLSCREEN ======
    document.getElementById('fullBtn').onclick = ()=>{
      const el = document.getElementById('viewer');
      if(!document.fullscreenElement){ el.requestFullscreen?.(); }
      else { document.exitFullscreen?.(); }
    };

    // ====== TOGGLE THUMBS ======
    document.getElementById('toggleThumbs').onclick = ()=>{
      thumbRow.classList.toggle('hidden');
    };

    // ====== INIT ======
    loadHosted();
  </script>
</body>
</html>

